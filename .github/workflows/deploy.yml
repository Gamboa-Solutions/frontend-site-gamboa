name: Deploy to Azure VM

on:
  push:
    branches:
      - main # or your default branch

jobs:
  deploy:
    runs-on: ubuntu-latest

    steps:
      - name: Checkout code
        uses: actions/checkout@v2

      - name: Deploy to Azure VM
        AZURE_SSH_PRIVATE_KEY: ${{ secrets.AZURE_SSH_PRIVATE_KEY }}
        AZURE_HOST: ${{ secrets.AZURE_HOST }}
        AZURE_USERNAME: ${{ secrets.AZURE_USERNAME }}

        run:
          ssh -i private_key.pem $AZURE_USERNAME@$AZURE_HOST "cd /home/azureuser/ && git pull && docker-compose up -d"
        shell: /usr/bin/bash -e {0}
        env:


